import{u as z,_ as L}from"./CeaK9w5d.js";import{u as j}from"./DiAEQvm2.js";import{q as R,h as T,n as _,o as V,c as A,b as f,s as W,u as o,v as U,w as v,d as K,x as E,a as w,t as I,r as Z,y as B,z as G,A as Q}from"./Qx7K5HX-.js";import{u as q,a as X}from"./CGiCrOzS.js";import{_ as Y}from"./Zl6chKFv.js";const H=(a={})=>{let t={};return t.list=j({...a,method:"post",url:"dimona://api/backend/products/filtered",params:{page:1},data:{search:null,categories:[],collections:[],colors:[],sizes:[],customizable:"only",order_by:"sales",per_page:100},response:{data:[]},responseParse(e){return e.data=e.data.map(s=>(s.dimonaUrl=`https://camisadimona.com.br/produto/${s.slug}/`,s)),e}}),t.find=j({...a,method:"get",response:!1,find(e){e&&(t.find.url=`dimona://api/backend/products/${e}`,setTimeout(()=>{t.find.submit()},1e3))},beforeSubmit(){t.find.response=!1}}),t},ee={class:"mb-5"},te={class:"text-center font-weight-bold bg-success py-5"},se={__name:"product-select",props:{modelValue:{type:[Number,Object],default:null}},emits:["update:modelValue","update:attributes"],setup(a,{emit:t}){const e=a,s=z(),n=t,l=H();l.find.on("success",u=>{l.list.response.data=[u.data]});const i=u=>{n("update:modelValue",u),l.find.find(u)},r=R({t:null,handler(u){u&&(r.t&&clearTimeout(r.t),r.t=setTimeout(()=>{l.list.data.search=u,l.list.submit()},1e3))}});return T(()=>e.modelValue,u=>{l.find.response=!1,l.find.find(u)}),(u,m)=>{const h=_("v-autocomplete"),c=_("v-card-text"),k=_("v-card"),g=_("v-expansion-panel-text"),y=_("v-expansion-panel"),d=_("v-expansion-panels"),p=_("v-btn"),b=_("v-card-actions");return V(),A("div",ee,[f(h,W(u.$attrs,{items:o(l).list.response.data,loading:o(l).list.busy||o(l).find.busy,"item-value":"slug","item-title":"name","model-value":e.modelValue,"hide-details":"","onUpdate:modelValue":i,"onUpdate:search":o(r).handler}),null,16,["items","loading","model-value","onUpdate:search"]),o(l).find.busy?(V(),U(k,{key:0},{default:v(()=>[f(c,{class:"text-center"},{default:v(()=>[K("Carregando")]),_:1})]),_:1})):E("",!0),!o(l).find.busy&&o(l).find.response?(V(),U(k,{key:1,loading:o(l).find.busy},{default:v(()=>[w("div",te," PreÃ§o Dimona: R$ "+I(o(s).numberToMoney(o(l).find.response.price)),1),f(d,{variant:"accordion"},{default:v(()=>[f(y,{title:`Cores (${o(l).find.response.colors.length})`},{default:v(()=>[f(g,null,{default:v(()=>[w("pre",null,I(o(l).find.response.colors),1)]),_:1})]),_:1},8,["title"]),f(y,{title:`Tamanhos (${o(l).find.response.sizes.length})`},{default:v(()=>[f(g,null,{default:v(()=>[w("pre",null,I(o(l).find.response.sizes),1)]),_:1})]),_:1},8,["title"])]),_:1}),f(b,{class:"justify-end"},{default:v(()=>[f(p,{text:"Adicionar todos os atributos",class:"bg-primary",onClick:m[0]||(m[0]=()=>{n("update:attributes",{colors:o(l).find.response.colors,sizes:o(l).find.response.sizes})})})]),_:1})]),_:1},8,["loading"])):E("",!0)])}}};var ne=Object.defineProperty,ae=(a,t,e)=>t in a?ne(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,N=(a,t,e)=>ae(a,typeof t!="symbol"?t+"":t,e);const F={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}},O=(a,t,e)=>a.replaceAll(t,"").replace(e,".").replace("..",".").replace(/[^.\d]/g,""),D=(a,t,e)=>{var s;return new Intl.NumberFormat(((s=e.number)==null?void 0:s.locale)??"en",{minimumFractionDigits:a,maximumFractionDigits:t,roundingMode:"trunc"})},oe=(a,t=!0,e)=>{var s,n,l,i;const r=((s=e.number)==null?void 0:s.unsigned)==null&&a.startsWith("-")?"-":"",u=((n=e.number)==null?void 0:n.fraction)??0;let m=D(0,u,e);const h=m.formatToParts(1000.12),c=((l=h.find(p=>p.type==="group"))==null?void 0:l.value)??" ",k=((i=h.find(p=>p.type==="decimal"))==null?void 0:i.value)??".",g=O(a,c,k);if(Number.isNaN(parseFloat(g)))return r;const y=g.split(".");if(y[1]!=null&&y[1].length>=1){const p=y[1].length<=u?y[1].length:u;m=D(p,u,e)}let d=m.format(parseFloat(g));return t?u>0&&g.endsWith(".")&&!g.slice(0,-1).includes(".")&&(d+=k):d=O(d,c,k),r+d};class le{constructor(t={}){N(this,"opts",{}),N(this,"memo",new Map);const e={...t};if(e.tokens!=null){e.tokens=e.tokensReplace?{...e.tokens}:{...F,...e.tokens};for(const s of Object.values(e.tokens))typeof s.pattern=="string"&&(s.pattern=new RegExp(s.pattern))}else e.tokens=F;Array.isArray(e.mask)&&(e.mask.length>1?e.mask=[...e.mask].sort((s,n)=>s.length-n.length):e.mask=e.mask[0]??""),e.mask===""&&(e.mask=null),this.opts=e}masked(t){return this.process(t,this.findMask(t))}unmasked(t){return this.process(t,this.findMask(t),!1)}isEager(){return this.opts.eager===!0}isReversed(){return this.opts.reversed===!0}completed(t){const e=this.findMask(t);if(this.opts.mask==null||e==null)return!1;const s=this.process(t,e).length;return typeof this.opts.mask=="string"?s>=this.opts.mask.length:s>=e.length}findMask(t){const e=this.opts.mask;if(e==null)return null;if(typeof e=="string")return e;if(typeof e=="function")return e(t);const s=this.process(t,e.slice(-1).pop()??"",!1);return e.find(n=>this.process(t,n,!1).length>=s.length)??""}escapeMask(t){const e=[],s=[];return t.split("").forEach((n,l)=>{n==="!"&&t[l-1]!=="!"?s.push(l-s.length):e.push(n)}),{mask:e.join(""),escaped:s}}process(t,e,s=!0){if(this.opts.number!=null)return oe(t,s,this.opts);if(e==null)return t;const n=`v=${t},mr=${e},m=${s?1:0}`;if(this.memo.has(n))return this.memo.get(n);const{mask:l,escaped:i}=this.escapeMask(e),r=[],u=this.opts.tokens!=null?this.opts.tokens:{},m=this.isReversed()?-1:1,h=this.isReversed()?"unshift":"push",c=this.isReversed()?0:l.length-1,k=this.isReversed()?()=>p>-1&&b>-1:()=>p<l.length&&b<t.length,g=M=>!this.isReversed()&&M<=c||this.isReversed()&&M>=c;let y,d=-1,p=this.isReversed()?l.length-1:0,b=this.isReversed()?t.length-1:0,S=!1;for(;k();){const M=l.charAt(p),x=u[M],$=(x==null?void 0:x.transform)!=null?x.transform(t.charAt(b)):t.charAt(b);if(!i.includes(p)&&x!=null?($.match(x.pattern)!=null?(r[h]($),x.repeated?(d===-1?d=p:p===c&&p!==d&&(p=d-m),c===d&&(p-=m)):x.multiple&&(S=!0,p-=m),p+=m):x.multiple?S&&(p+=m,b-=m,S=!1):$===y?y=void 0:x.optional&&(p+=m,b-=m),b+=m):(s&&!this.isEager()&&r[h](M),$===M&&!this.isEager()?b+=m:y=M,this.isEager()||(p+=m)),this.isEager())for(;g(p)&&(u[l.charAt(p)]==null||i.includes(p));){if(s){if(r[h](l.charAt(p)),t.charAt(b)===l.charAt(p)){p+=m,b+=m;continue}}else l.charAt(p)===t.charAt(b)&&(b+=m);p+=m}}return this.memo.set(n,r.join("")),this.memo.get(n)}}const J=a=>JSON.parse(a.replaceAll("'",'"')),ie=(a,t={})=>{const e={...t};a.dataset.maska!=null&&a.dataset.maska!==""&&(e.mask=re(a.dataset.maska)),a.dataset.maskaEager!=null&&(e.eager=C(a.dataset.maskaEager)),a.dataset.maskaReversed!=null&&(e.reversed=C(a.dataset.maskaReversed)),a.dataset.maskaTokensReplace!=null&&(e.tokensReplace=C(a.dataset.maskaTokensReplace)),a.dataset.maskaTokens!=null&&(e.tokens=ue(a.dataset.maskaTokens));const s={};return a.dataset.maskaNumberLocale!=null&&(s.locale=a.dataset.maskaNumberLocale),a.dataset.maskaNumberFraction!=null&&(s.fraction=parseInt(a.dataset.maskaNumberFraction)),a.dataset.maskaNumberUnsigned!=null&&(s.unsigned=C(a.dataset.maskaNumberUnsigned)),(a.dataset.maskaNumber!=null||Object.values(s).length>0)&&(e.number=s),e},C=a=>a!==""?!!JSON.parse(a):!0,re=a=>a.startsWith("[")&&a.endsWith("]")?J(a):a,ue=a=>{if(a.startsWith("{")&&a.endsWith("}"))return J(a);const t={};return a.split("|").forEach(e=>{const s=e.split(":");t[s[0]]={pattern:new RegExp(s[1]),optional:s[2]==="optional",multiple:s[2]==="multiple",repeated:s[2]==="repeated"}}),t};class de{constructor(t,e={}){N(this,"items",new Map),N(this,"onInput",s=>{if(s instanceof CustomEvent&&s.type==="input"&&!s.isTrusted)return;const n=s.target,l=this.items.get(n),i="inputType"in s&&s.inputType.startsWith("delete"),r=l.isEager(),u=i&&r&&l.unmasked(n.value)===""?"":n.value;this.fixCursor(n,i,()=>this.setValue(n,u))}),this.options=e,this.init(this.getInputs(t))}update(t={}){this.options={...t},this.init(Array.from(this.items.keys()))}updateValue(t){t.value!==""&&t.value!==this.processInput(t).masked&&this.setValue(t,t.value)}destroy(){for(const t of this.items.keys())t.removeEventListener("input",this.onInput);this.items.clear()}init(t){const e=this.getOptions(this.options);for(const s of t){this.items.has(s)||s.addEventListener("input",this.onInput,{capture:!0});const n=new le(ie(s,e));this.items.set(s,n),queueMicrotask(()=>this.updateValue(s)),s.selectionStart===null&&n.isEager()&&console.warn("Maska: input of `%s` type is not supported",s.type)}}getInputs(t){return typeof t=="string"?Array.from(document.querySelectorAll(t)):"length"in t?Array.from(t):[t]}getOptions(t){const{onMaska:e,preProcess:s,postProcess:n,...l}=t;return l}fixCursor(t,e,s){const n=t.selectionStart,l=t.value;if(s(),n===null||n===l.length&&!e)return;const i=t.value,r=l.slice(0,n),u=i.slice(0,n),m=this.processInput(t,r).unmasked,h=this.processInput(t,u).unmasked;let c=n;r!==u&&(c+=e?i.length-l.length:m.length-h.length),t.setSelectionRange(c,c)}setValue(t,e){const s=this.processInput(t,e);t.value=s.masked,this.options.onMaska!=null&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(n=>n(s)):this.options.onMaska(s)),t.dispatchEvent(new CustomEvent("maska",{detail:s})),t.dispatchEvent(new CustomEvent("input",{detail:s.masked}))}processInput(t,e){const s=this.items.get(t);let n=e??t.value;this.options.preProcess!=null&&(n=this.options.preProcess(n));let l=s.masked(n);return this.options.postProcess!=null&&(l=this.options.postProcess(l)),{masked:l,unmasked:s.unmasked(n),completed:s.completed(n)}}}const P=new WeakMap,me=(a,t)=>{if(a.arg==null||a.instance==null)return;const e="setup"in a.instance.$.type;a.arg in a.instance?a.instance[a.arg]=t:e&&console.warn("Maska: please expose `%s` using defineExpose",a.arg)},pe=(a,t)=>{var e;const s=a instanceof HTMLInputElement?a:a.querySelector("input");if(s==null||(s==null?void 0:s.type)==="file")return;let n={};if(t.value!=null&&(n=typeof t.value=="string"?{mask:t.value}:{...t.value}),t.arg!=null){const l=i=>{const r=t.modifiers.unmasked?i.unmasked:t.modifiers.completed?i.completed:i.masked;me(t,r)};n.onMaska=n.onMaska==null?l:Array.isArray(n.onMaska)?[...n.onMaska,l]:[n.onMaska,l]}P.has(s)?(e=P.get(s))==null||e.update(n):P.set(s,new de(s,n))},ce={__name:"money",props:{modelValue:{type:[Number],default:""}},emits:["update:modelValue"],setup(a,{emit:t}){const e=z(),s=a,n=t,l=Z(null),i=R({number:0,string:""});return i.number=s.modelValue||0,i.string=e.numberToMoney(i.number),T(()=>s.modelValue,r=>{document.activeElement==l.value.$el||l.value.$el.contains(document.activeElement)||(i.number=r||0,i.string=e.numberToMoney(i.number))}),(r,u)=>{const m=_("v-text-field");return B((V(),U(m,W(r.$attrs,{ref_key:"inputRef",ref:l,modelValue:o(i).string,"onUpdate:modelValue":[u[0]||(u[0]=h=>o(i).string=h),u[1]||(u[1]=h=>{o(i).number=o(e).moneyToNumber(h),n("update:modelValue",o(i).number)})],onFocus:u[2]||(u[2]=h=>h.target.select())}),null,16,["modelValue"])),[[o(pe),{mask:"9.99#,##",reversed:!0,tokens:{9:{pattern:/[0-9]/,repeated:!0}}}]])}}},fe={class:"mb-5"},he=["onUpdate:modelValue"],ve={key:1},_e={key:2},ke=["src"],ge={__name:"attributes-edit",props:{modelValue:{type:[Array],default:()=>[]},type:{type:[String],default:null}},emits:["update:modelValue"],setup(a,{emit:t}){const e=a,s=t,n={colors:{id:null,name:null,hexadecimal:null},sizes:{id:null,name:null},prints:{id:null,name:null,url:null}},{storageUpload:l}=q(),i=R({items:[],add(r={}){i.items.push(i.defaults(r)),s("update:modelValue",i.items)},remove(r){const u=i.items.indexOf(r);i.items.splice(u,1),s("update:modelValue",i.items)},set(r){i.items=e.modelValue.map(u=>i.defaults(u))},defaults(r){return typeof n[e.type]<"u"?{...n[e.type],...r}:r}});return i.set(e.modelValue),T(()=>e.modelValue,r=>{i.set(r)}),(r,u)=>{const m=_("v-btn"),h=L;return V(),A("div",fe,[f(h,{headers:[{field:"name",name:"Nome"},{field:"value",name:"Valor",width:"150px"}],items:o(i).items,actions:c=>[{text:"Upload",icon:"mdi-upload",showIf(){return e.type=="prints"},onClick(){o(l)({onSuccess(g){c.item.url=g.url,s("update:modelValue",o(i).items)}}).browse()}},{text:"Deletar",icon:"mdi-delete",onClick(){o(i).remove(c.item)}}]},{"item:name":v(c=>[B(w("input",{type:"text","onUpdate:modelValue":k=>c.item.name=k,class:"w-100 pa-3",placeholder:"Nome",onInput:u[0]||(u[0]=()=>{s("update:modelValue",o(i).items)})},null,40,he),[[G,c.item.name]])]),"item:value":v(c=>[e.type=="colors"?(V(),U(m,{key:0,color:c.item.hexadecimal,block:""},null,8,["color"])):E("",!0),e.type=="sizes"?(V(),A("div",ve)):E("",!0),e.type=="prints"?(V(),A("div",_e,[c.item.url?(V(),A("img",{key:0,src:c.item.url,alt:"",style:{width:"100%",height:"100px","object-fit":"contain"}},null,8,ke)):E("",!0)])):E("",!0)]),_:1},8,["items","actions"]),f(m,{block:"",text:"Add",color:"primary",onClick:u[1]||(u[1]=c=>o(i).add())})])}}},be=["src"],ye={__name:"firebase-upload",props:{modelValue:{type:[String],default:""}},emits:["update:modelValue"],setup(a,{emit:t}){const{storageUpload:e}=q(),s=e({onSuccess(r){i.url=r.url,l("update:modelValue",r.url)}}),n=a,l=t,i=R({url:n.modelValue,isImage(){if(this.url){const r=new URL(this.url);if(r.pathname&&(r.pathname.endsWith(".jpg")||r.pathname.endsWith(".jpeg")||r.pathname.endsWith(".gif")||r.pathname.endsWith(".bmp")||r.pathname.endsWith(".png")||r.pathname.endsWith(".webp")))return!0}return!1}});return T(()=>n.modelValue,r=>{i.url=r}),(r,u)=>{const m=_("v-expand-transition"),h=_("v-text-field"),c=_("v-card");return V(),U(c,null,{default:v(()=>[f(m,null,{default:v(()=>[o(i).isImage()?(V(),A("img",{key:0,src:o(i).url,alt:"",style:{width:"100%","margin-bottom":"-4px"}},null,8,be)):E("",!0)]),_:1}),f(h,W({modelValue:o(i).url,"onUpdate:modelValue":u[0]||(u[0]=k=>o(i).url=k),readonly:"","hide-details":""},r.$attrs,{"prepend-icon":null,"append-inner-icon":o(i).url?"mdi-delete":"mdi-upload","onClick:appendInner":u[1]||(u[1]=()=>{if(o(i).url){o(i).url=null,l("update:modelValue",null);return}o(s).browse()})}),null,16,["modelValue","append-inner-icon"])]),_:1})}}},Ve=w("br",null,null,-1),xe={class:"d-flex justify-end ga-3"},we=w("br",null,null,-1),Me={class:"d-flex justify-end ga-3"},Ne={__name:"product",setup(a){const t=z();H();const e=X();return Q(()=>{e.list.submit()}),(s,n)=>{const l=se,i=_("v-text-field"),r=ce,u=ge,m=ye,h=_("v-btn"),c=_("v-col"),k=L,g=_("v-row"),y=Y;return V(),U(y,{name:"admin"},{default:v(()=>[w("div",null,[f(g,null,{default:v(()=>[f(c,{cols:"6"},{default:v(()=>[f(l,{label:"Referencia produto Dimona",modelValue:o(e).save.data.dimonaProductSlug,"onUpdate:modelValue":n[0]||(n[0]=d=>o(e).save.data.dimonaProductSlug=d),"onUpdate:attributes":n[1]||(n[1]=d=>{o(e).save.data.sizes=d.sizes,o(e).save.data.colors=d.colors})},null,8,["modelValue"]),f(i,{label:"Nome",modelValue:o(e).save.data.name,"onUpdate:modelValue":n[2]||(n[2]=d=>o(e).save.data.name=d)},null,8,["modelValue"]),f(i,{label:"SKU",modelValue:o(e).save.data.sku,"onUpdate:modelValue":n[3]||(n[3]=d=>o(e).save.data.sku=d),"append-inner-icon":"zondicons:bookmark-copy-2","onClick:appendInner":n[4]||(n[4]=()=>{o(e).save.data.sku=o(t).stringSlugify(o(e).save.data.name)})},null,8,["modelValue"]),f(r,{label:"Valor",modelValue:o(e).save.data.amount,"onUpdate:modelValue":n[5]||(n[5]=d=>o(e).save.data.amount=d)},null,8,["modelValue"]),f(u,{label:"Cores",type:"colors",modelValue:o(e).save.data.colors,"onUpdate:modelValue":n[6]||(n[6]=d=>o(e).save.data.colors=d)},null,8,["modelValue"]),f(u,{label:"Tamanhos",type:"sizes",modelValue:o(e).save.data.sizes,"onUpdate:modelValue":n[7]||(n[7]=d=>o(e).save.data.sizes=d)},null,8,["modelValue"]),f(u,{label:"Estampas",type:"prints",modelValue:o(e).save.data.prints,"onUpdate:modelValue":n[8]||(n[8]=d=>o(e).save.data.prints=d)},null,8,["modelValue"]),f(m,{label:"Thumbnail",modelValue:o(e).save.data.thumbnail,"onUpdate:modelValue":n[9]||(n[9]=d=>o(e).save.data.thumbnail=d)},null,8,["modelValue"]),Ve,w("div",xe,[f(h,{text:"Limpar",onClick:n[10]||(n[10]=async()=>{o(e).save.dataClear()})}),f(h,{text:"Salvar",color:"success",loading:o(e).save.busy,onClick:n[11]||(n[11]=async()=>{await o(e).save.submit(),await o(e).list.submit(),await o(e).save.dataClear()})},null,8,["loading"])])]),_:1}),f(c,{cols:"6"},{default:v(()=>[f(k,{items:o(e).list.data,headers:[{name:"Nome",field:"name"},{name:"SKU",field:"sku",width:"200px"}],actions:d=>[{text:"Edit",color:"primary",icon:"mdi-pen",onClick(){o(e).save.data={...d.item}}},{text:"Delete",icon:"mdi-delete",color:"error",async onClick(){await o(e).delete.delete(d.item),await o(e).list.submit()}}]},null,8,["items","actions"]),we,w("div",Me,[f(h,{text:"Buscar",loading:o(e).list.busy,onClick:n[12]||(n[12]=async()=>{await o(e).list.submit()})},null,8,["loading"])])]),_:1})]),_:1})])]),_:1})}}};export{Ne as default};
